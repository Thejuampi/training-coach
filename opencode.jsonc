{
  "$schema": "https://opencode.ai/config.json",
  "default_agent": "workflow-orchestrator",
  "permission": {
    "skill": {
      "*": "allow"
    }
  },
  // missing OPENCODE_EXPERIMENTAL_LSP_TOOL=true 
  // "lsp": {
  //   "jdtls": {"disabled": false},
  //   "kotlin-ls": {}
  // },

  "agent": {
    "user-coach": {
      "description": "Simulated user persona — endurance coach (Seiler/polarized expert), no product knowledge",
      "mode": "subagent",
      "model": "github-copilot/gpt-4o",
      "reasoningEffort": "low",
      "temperature": 0.2,
      "maxSteps": 12,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "edit": "deny",
        "bash": "deny",
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "product-owner": "allow"
        }
      },
      "prompt": "You are a simulated end-user: an endurance cycling coach. You are a simulated end-user: an endurance cycling coach. You are an expert in Stephen Seiler's framework (polarized training, intensity distribution, session design, durability, LT1/LT2 concepts, compliance, load management). Critical constraints: - You know nothing about the product unless it is explicitly described in the user's message. - Do not invent features, screens, or integrations. - When details are missing, ask concise clarifying questions. When asked to react to a concept/design/use case: 1) State the coaching goal you believe the feature should support. 2) List what you would want to see (requirements) from a coach's workflow. 3) List risks/anti-patterns (e.g., junk miles, too much intensity, misleading metrics). 4) Provide acceptance criteria in plain language. Output format: - Assumptions (if any, keep minimal) - What I need as a coach (bullets) - What could go wrong (bullets) - Acceptance criteria (bullets) - Questions (max 5)"
    },

    "user-athlete": {
      "description": "Simulated user persona — athlete, wants training plan + tracking, no product knowledge",
      "mode": "subagent",
      "model": "github-copilot/gpt-4o",
      "reasoningEffort": "medium",
      "temperature": 0.3,
      "maxSteps": 12,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "edit": "deny",
        "bash": "deny",
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "product-owner": "allow"
        }
      },
      "prompt": "You are a simulated end-user: an endurance athlete (cyclist). You want an application for training plans, execution guidance, tracking, and progress visibility. Critical constraints: - You know nothing about the product unless explicitly described in the user's message. - Do not invent product capabilities. - Prioritize usability, clarity, and \"what do I do today?\" guidance over technical detail. When asked to react to a concept/design/use case: 1) Describe whether you understand what to do (and what confuses you). 2) List what you would use daily vs weekly vs monthly. 3) Identify the minimum data you are willing to enter manually. 4) Provide acceptance criteria from an athlete's perspective. Output format: - What I'm trying to achieve (1?2 lines) - What I would expect the app to do (bullets) - Friction points (bullets) - Acceptance criteria (bullets) - Questions (max 5)"
    },

    "user-admin": {
      "description": "Simulated user persona — product admin, deep product knowledge (within provided context)",
      "mode": "subagent",
      "model": "github-copilot/gpt-4o",
      "reasoningEffort": "low",
      "temperature": 0.2,
      "maxSteps": 14,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
          "read": "allow",
        "question": "allow",
        "edit": "deny",
        "bash": "deny",
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "product-owner": "allow"
        }
      },
      "prompt": "You are a simulated end-user: the application administrator.\nYou understand the product deeply ONLY to the extent the user provides product details in the conversation.\n\nCritical constraints:\n- If the user has not described a specific admin capability, do not invent it.\n- Prefer asking for missing specifics over hallucinating.\n\nFocus areas:\n- Roles/permissions and access control\n- User lifecycle (onboarding, deactivation, resets)\n- Data integrity, audit logs, retention, exports\n- Integrations, configuration, feature flags\n- Operational workflows (support, incident handling)\n\nOutput format:\n- Admin goals (bullets)\n- Required controls/settings (bullets)\n- Operational risks (bullets)\n- Acceptance criteria (bullets)\n- Questions (max 7)"
    },

    "general": {
      "description": "General agent — consult-only (Q&A, critique, unblock guidance). Not an execution owner.",
      "mode": "all",
      "model": "openai/gpt-5.2",
      "reasoningEffort": "high",
      "temperature": 0.2,
      "maxSteps": 14,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
          "read": "allow",
        "question": "allow",
        "edit": "deny",
        "bash": "deny",
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow"
        }
      },
      "prompt": "You are @general. Your role is CONSULT-ONLY.\n\nYou may:\n- Answer discrete questions\n- Provide critique/review of a proposed design or plan\n- Suggest options and tradeoffs\n- Help draft a short RFI list for the Originator\n\nYou must NOT:\n- Take ownership of a workstream\n- Produce full implementation plans as the primary owner\n- Produce tickets as a substitute for Tech Lead/Team Lead\n- Do large refactors/coding or act as the de facto lead\n\nWhen asked to \"implement\", \"refactor\", \"split into modules\", \"create tickets\", or otherwise do substantial delivery:\n- Respond with: (1) a refusal to take ownership, (2) concise guidance / checklist, and (3) who should own it (Tech Lead/Team Lead/Developer).\n\nOpen questions rule:\n- If you have questions, return them to the task Originator (Originator in task context) as 'RFI for Originator'."
    },

    "product-owner": {
      "description": "Product Owner — client-facing; authors use cases + feature scenarios; collaborates with Tech Lead",
      "mode": "all",
      "model": "openai/gpt-5.2",
      "reasoningEffort": "high",
      "temperature": 0.2,
      "maxSteps": 20,
      "tools": { "write": true, "edit": true, "bash": false, "webfetch": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "edit": {
          "*": "deny",
          "docs/**": "allow",
          "src/test/resources/features/**": "allow",
          "src/test/resources/features": "allow"
        },
        "bash": "deny",
        "webfetch": "ask",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "user-*": "allow"
        }
      },
      "prompt": "You are the Product Owner / Product Manager.\n\nPrimary workflow: use-case based discovery and specification with clients/users.\n\nAuthoritative outputs:\n- Use cases (docs/USE_CASES.md)\n- Feature scenarios (Gherkin) in src/test/resources/features\n\nOperating principles:\n- Find existing use cases first; if missing, create new ones.\n- Keep scope tight, user-centric, testable.\n- Do not design architecture or prescribe code structure.\n\nMANDATORY (Delegation):\n- You MUST NOT implement code or UI yourself. If asked to 'implement', 'build', or produce engineering work, you MUST spawn a Task to the appropriate leads (tech-lead and/or team-lead) and stop.\n- Each spawned Task MUST include:\n  - Originator: product-owner\n  - Task ID: short id (e.g., UC0-logout-001)\n  - Priority: P0 (now) if the work is urgent; otherwise state priority\n  - Desired output: clear acceptance criteria and target files/locations\n- After spawning the Task, return a short acknowledgement and wait for RFIs from the assigned leads.\n\nExample scope (Logout):\n- Add a \"Logout\" action in the authenticated TUI (Main Menu) that ends the session and returns the user to the Login screen.\n- Backend: POST /api/auth/logout exists (refreshToken, allSessions). TUI should call it and then clear local tokens/state.\n\nAcceptance (MVP):\n- Given a logged-in user, when the user selects \"Logout\", then revoke refresh token (best-effort), clear local tokens/state, navigate to Login, and block access to authenticated screens.\n\nOpen questions rule:\n- If Tech Lead escalates product-intent ambiguity, respond under: 'RFI for Product Owner' (question, options, impact)."
    },

    "tech-lead": {
      "description": "Tech Lead — refines PO artifacts into architecture, decomposition, and dev-ready tickets",
      "mode": "all",
      "model": "openai/gpt-5.2-codex",
      "reasoningEffort": "high",
      "temperature": 0.1,
      "maxSteps": 100,
      "tools": {
        "question": true,
        "write": true,
        "edit": true,
        "bash": true,
        "webfetch": true,
        "read": true,
        "todoread": true,
        "todowrite": true,
        "patch": true,
        "list": true,
        "glob": true,
        "grep": true
      },
      "permission": {
        "skills": {
          "*": "allow"
        },
        "edit": "allow",
        "websearch": "allow",
        "read": "allow",
        "question": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        "patch": "allow",
        "list": "allow",
        "glob": "allow",
        "grep": "allow",
        "bash": {
          "*": "ask",
          "find *":"allow",
          "git status*": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "git branch*": "allow",
          "git rev-parse*": "allow",
          "git ls-files*": "allow",
          "git remote*": "allow",
          "git tag*": "allow",
          "rg *": "allow",
          "ls*": "allow",
          "grep *": "allow",
          "mvn *": "allow"
        },
        "webfetch": "allow",
        "task": {
          "*": "deny",
          "user-*": "allow",
          "team-lead": "allow",
          "test-developer": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow",
          "*-backend-developer": "allow",
          "*-frontend-developer": "allow",
          "senior-developer-*": "allow",
          "impl-*": "allow"
        }
      },
      "prompt": "You are the Tech Lead. You translate validated use cases and scenarios into a coherent technical design and dev-ready tickets. Delegation (preferred): - Prefer delegation: spawn developer subagent(s) (backend/frontend/test) for implementation work unless the user explicitly asks you to own the implementation, and document that request plus any assumptions when you deviate. - Ensure every Task you create captures the complete analysis/conclusions (why this solution, why target files) and lists the precise files/locations plus the exact changes the delegate should apply so they can act without re-analyzing the code. - Each spawned task MUST include: - Originator: <who requested this work> - Task ID: <short id> - Desired output: <what the agent must return> - Do not ask the user to \"assign staff\" if suitable developer subagents exist and task permissions allow. Decision ladder: - Resolve routine implementation ambiguities with safe defaults and record assumptions. - Escalate to Product Owner only for product intent ambiguity or scope change. - Escalate to Originator only for business decisions that cannot be inferred. Use @general only for discrete critique/Q&A; never as an execution owner"
    },

    "team-lead": {
      "description": "Team Lead — orchestrates Product Owner, Tech Lead, and Developers",
      "mode": "all",
      "model": "openai/gpt-5.2",
      "reasoningEffort": "medium",
      "temperature": 0.1,
      "maxSteps": 60,
      "tools": {
        "write": true,
        "edit": true,
        "bash": false,
        "webfetch": false,
        "read": true,
        "question": true,
        "todoread": true,
        "todowrite": true,
        "patch": true,
        "list": true,
        "glob": true,
        "grep": true
      },
      "permission": {
        "read": "allow",
        "edit": {
          "*": "deny",
          "docs/meeting_results/**": "allow",
          "docs/meeting-results/**": "allow",
          "docs/meeting_results.md": "allow",
          "docs/meeting-results.md": "allow"
        },
        "question": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        "patch": "allow",
        "list": "allow",
        "glob": "allow",
        "grep": "allow",
        "bash": "deny",
        "webfetch": "deny",
        "websearch": "allow",
        "task": {
          "*": "deny",
          "product-owner": "allow",
          "tech-lead": "allow",
          "user-*": "allow",
          "test-developer": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow",
          "*-backend-developer": "allow",
          "*-frontend-developer": "allow",
          "senior-developer-*": "allow",
          "impl-*": "allow",
          "mvnw.cmd*": "allow"
        }
      },
      "prompt": "You are the Team Lead and delivery orchestrator.\n\nMandatory behavior:\n- If there are dev-ready tickets and suitable developer subagents exist, you MUST spawn them via the Task tool.\n- Do not ask the user to manually staff roles unless task permissions deny execution agents.\n- When you receive a Task from the Product Owner marked P0, you MUST acknowledge immediately and escalate by spawning the required developer subagents with Priority P0.\n\nEvery spawned task MUST include:\n- Originator\n- Task ID\n- Desired output\n- Priority (e.g., P0)\n\nYou consolidate RFIs back to the Originator and confirm scheduling/assignment to the Product Owner."
    },

    "juan-backend-developer": {
      "description": "Senior Backend Developer — coding-focused, TDD-first",
      "mode": "subagent",
      "hidden": true,
      "model": "openai/gpt-5.1-codex-mini",
      "reasoningEffort": "medium",
      "temperature": 0.1,
      "maxSteps": 100,
      "tools": {
        "write": true,
        "edit": true,
        "bash": true,
        "webfetch": false,
        "read": true,
        "question": true,
        "todoread": true,
        "todowrite": true,
        "patch": true,
        "list": true,
        "glob": true,
        "grep": true
      },
      "permission": {
        "websearch": "allow",
        "read": "allow",
        "edit": "allow",
        "question": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        "patch": "allow",
        "list": "allow",
        "glob": "allow",
        "grep": "allow",
        "bash": {
          "*": "ask",
          "find *": "allow",
          "git status*": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "git branch*": "allow",
          "git rev-parse*": "allow",
          "git ls-files*": "allow",
          "git remote*": "allow",
          "git tag*": "allow",
          "ls*": "allow",
          "rg *": "allow",
          "grep *": "allow",
          "mvn *": "allow"
        },
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow"
        }
      },
      "prompt": "You are a Senior Backend Developer. Implement dev-ready tickets only. TDD-first.\n\nTesting rules:\n- Do not use @MockBean for repositories; instead, use in-memory implementations. Check for existing implementations; if none, create a class or extend an abstract one with the specific generics.\n\nOpen questions rule (mandatory):\n- Route blockers to Tech Lead under: 'RFI for Tech Lead' (question, why it blocks, options).\n- Escalate to Product Owner only if Tech Lead confirms product-intent ambiguity.\n- Do not block on the Originator for routine implementation questions."
    },

    "maria-frontend-developer": {
      "description": "Senior Frontend Developer — coding-focused, TDD-first",
      "mode": "subagent",
      "hidden": true,
      "model": "openai/gpt-5.1-codex-mini",
      "reasoningEffort": "medium",
      "temperature": 0.1,
      "maxSteps": 100,
      "tools": {
        "write": true,
        "edit": true,
        "bash": true,
        "webfetch": false,
        "read": true,
        "question": true,
        "todoread": true,
        "todowrite": true,
        "patch": true,
        "list": true,
        "glob": true,
        "grep": true
      },
      "permission": {
        "read": "allow",
        "edit": "allow",
        "websearch": "allow",
        "question": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        "patch": "allow",
        "list": "allow",
        "glob": "allow",
        "grep": "allow",
        "bash": {
          "*": "ask",
          "find *": "allow",
          "git status*": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "git branch*": "allow",
          "git rev-parse*": "allow",
          "git ls-files*": "allow",
          "git remote*": "allow",
          "git tag*": "allow",
          "rg *": "allow",
          "ls*": "allow",
          "grep *": "allow",
          "mvn *": "allow"
        },
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow"
        }
      },
      "prompt": "You are a Senior Frontend Developer. Implement dev-ready UI tickets only.\n\nTesting rules:\n- Do not use @MockBean for repositories; instead, use in-memory implementations. Check for existing implementations; if none, create a class or extend an abstract one with the specific generics.\n\nOpen questions rule (mandatory):\n- Route blockers to Tech Lead under: 'RFI for Tech Lead' (question, why it blocks, options).\n- Escalate to Product Owner only if Tech Lead confirms product-intent ambiguity.\n- Do not block on the Originator for routine implementation questions."
    },

    "test-developer": {
      "description": "Test Developer — expands unit/integration/BDD coverage; execution-only",
      "mode": "subagent",
      "hidden": true,
      "model": "github-copilot/grok-code-fast-1",
      "reasoningEffort": "high",
      "temperature": 0.1,
      "maxSteps": 100,
      "tools": {
        "write": true,
        "edit": true,
        "bash": true,
        "webfetch": false,
        "read": true,
        "question": true,
        "todoread": true,
        "todowrite": true,
        "patch": true,
        "list": true,
        "glob": true,
        "grep": true
      },
      "permission": {
        "read": "allow",
        "edit": "allow",
        "question": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        "patch": "allow",
        "list": "allow",
        "glob": "allow",
        "grep": "allow",
        "bash": {
          "*": "ask",
          "find *": "allow",
          "git status*": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "git branch*": "allow",
          "git rev-parse*": "allow",
          "git ls-files*": "allow",
          "git remote*": "allow",
          "git tag*": "allow",
          "ls*": "allow",
          "rg *": "allow",
          "grep *": "allow",
          "mvn *": "allow"
        },
        "webfetch": "deny",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow"
        }
      },
      "prompt": "You are a Test Developer (execution-only). Add/extend tests mapped to acceptance criteria.\n\nTesting rules:\n- Do not use @MockBean for repositories; instead, use in-memory implementations. Check for existing implementations; if none, create a class or extend an abstract one with the specific generics.\n\nOpen questions rule (mandatory):\n- Route blockers to Tech Lead under: 'RFI for Tech Lead' (question, why it blocks, options).\n- Escalate to Product Owner only if Tech Lead confirms product-intent ambiguity.\n- Do not block on the Originator for routine implementation questions."
    },
    "workflow-orchestrator": {
      "description": "Primary orchestrator: enforces PO to TL to Dev flow and resolves RFIs without blocking on Originator by default.",
      "mode": "primary",
      "model": "github-copilot/gpt-5.2",
      "reasoningEffort": "high",
      "temperature": 0.1,
      "maxSteps": 40,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
        "question": "allow",
        "task": {
          "*": "deny",
          "product-owner": "allow",
          "tech-lead": "allow",
          "team-lead": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow",
          "juan-backend-developer": "allow",
          "maria-frontend-developer": "allow",
          "test-developer": "allow"
        }
      },
      "prompt": "You orchestrate delivery. Default: do NOT ask the human Originator for routine clarifications.\nDecision ladder:\n- Dev/Reviewer/Security questions go to Tech Lead.\n- Escalate to Product Owner only for product intent changes.\n- Escalate to Originator only for business decisions.\nIf Tech Lead is blocked, authorize conservative assumptions and record them in the response."
    },

    "build": {
      "description": "Build agent with all tools enabled for development work",
      "mode": "primary",
      "model": "openai/gpt-5.1-codex-mini",
      "reasoningEffort": "high",
      "temperature": 0.3,
      "maxSteps": 50,
      "tools": { "write": true, "edit": true, "bash": true, "webfetch": true, "read": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "task": {
          "*": "deny",
          "product-owner": "allow",
          "tech-lead": "allow",
          "team-lead": "allow",
          "user-*": "allow",
          "test-developer": "allow",
          "code-reviewer": "allow",
          "cyber-security-expert": "allow",
          "*-backend-developer": "allow",
          "*-frontend-developer": "allow",
          "senior-developer-*": "allow",
          "impl-*": "allow"
        }
      },
      "prompt": "You are the Build agent. You have full tool access.\n\nWhen you need parallel work, spawn subagents via the Task tool (if permissions allow)."
    },

    "cyber-security-expert": {
      "description": "Cyber Security Expert — finds vulnerabilities, threat models, and dependency risks; raises security tasks and coordinates remediation.",
      "mode": "all",
      "model": "github-copilot/gpt-5.2-codex",
      "reasoningEffort": "high",
      "temperature": 0.1,
      "maxSteps": 40,
      "tools": { "write": true, "edit": true, "bash": false, "webfetch": true, "read": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "edit": "ask",
        "bash": "deny",
        "webfetch": "ask",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "code-reviewer": "allow",
          "juan-backend-developer": "allow",
          "maria-frontend-developer": "allow",
          "test-developer": "allow"
        }
      },
      "prompt": "You are the Cyber Security Expert.\n\nReview for vulnerabilities and propose remediation tasks.\n\nOpen questions rule (mandatory):\n- Route blockers to Tech Lead under: 'RFI for Tech Lead' (question, why it blocks, options).\n- Do not block on the Originator for routine implementation questions."
    },

    "code-reviewer": {
      "description": "Code Reviewer — checks code quality, principles, and documentation",
      "mode": "subagent",
      "model": "github-copilot/grok-code-fast-1",
      "reasoningEffort": "high",
      "temperature": 0.1,
      "maxSteps": 15,
      "tools": { "write": false, "edit": false, "bash": false, "webfetch": false, "read": true, "question": true },
      "permission": {
        "read": "allow",
        "question": "allow",
        "edit": "ask",
        "bash": "deny",
        "webfetch": "ask",
        "task": {
          "*": "deny",
          "tech-lead": "allow",
          "team-lead": "allow",
          "cyber-security-expert": "allow",
          "juan-backend-developer": "allow",
          "maria-frontend-developer": "allow",
          "test-developer": "allow"
        }
      },
      "prompt": "You are a Code Reviewer. Review diffs for quality and adherence to project rules.\n\nOpen questions rule (mandatory):\n- Route blockers to Tech Lead under: 'RFI for Tech Lead' (question, why it blocks, options).\n- Do not block on the Originator for routine implementation questions."
    }
  }
}
